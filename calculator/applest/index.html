<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™½é‡‘è‹¹æœæŠ½å¥–æ¨¡æ‹Ÿå™¨</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
        }
        body { background-color: #f8f9fa; }
        .container { padding: 2rem; }
        .card { border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .item-list { max-height: 400px; overflow-y: auto; }
        .log-entry { 
            border-left: 3px solid var(--secondary-color);
            padding: 0.5rem 1rem;
            margin: 0.5rem 0;
            background: rgba(52, 152, 219, 0.05);
        }
        .progress-bar {
            height: 4px;
            background: var(--secondary-color);
            transition: width 0.3s ease;
        }
        .treasure-path { color: #e74c3c; font-weight: 500; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4">ğŸ ç™½é‡‘è‹¹æœæŠ½å¥–æ¨¡æ‹Ÿ</h1>
        <h5 class="text-center mb-4">@bilibili ç´«ç”µNS</h5>
        <!-- å®ç‰©ç›’å±•ç¤º -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card p-3">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>ğŸ¯ é€‰æ‹©ç›®æ ‡é“å…·</h5>
                            <div class="item-list" id="targetItems"></div>
                        </div>
                        <div class="col-md-6">
                            <h5>ğŸ“Š å®æ—¶ç»Ÿè®¡</h5>
                            <div>å½“å‰è¿›åº¦: <span id="attemptCount">0</span> æ¬¡</div>
                            <div class="progress mt-2">
                                <div class="progress-bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ§åˆ¶åŒº -->
        <div class="card p-3 mb-4">
            <div class="d-flex gap-3 align-items-center">
                <button class="btn btn-primary btn-lg" onclick="startDrawing()" id="startBtn">â–¶ï¸ å¼€å§‹æŠ½å–</button>
                <button class="btn btn-danger btn-lg" onclick="stopDrawing()" id="stopBtn" disabled>â¹ï¸ åœæ­¢</button>
                <div class="form-check ms-auto">
                    <input class="form-check-input" type="checkbox" id="autoContinue">
                    <label class="form-check-label" for="autoContinue">è‡ªåŠ¨ç»§ç»­</label>
                </div>
            </div>
        </div>

        <!-- å±•ç¤ºåŒº -->
        <div class="row">
            <div class="col-md-6">
                <div class="card p-3">
                    <h5>ğŸ“œ æŠ½å–æ—¥å¿—</h5>
                    <div id="resultLogs" style="height: 400px; overflow-y: auto;"></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card p-3">
                    <h5>ğŸ“ˆ é¢‘ç‡åˆ†å¸ƒ</h5>
                    <canvas id="frequencyChart"></canvas>
                </div>
            </div>
        </div>
    </div>

<script>
// å¥–æ± é…ç½®æ•°æ®
const categories = [
    {
    name: "è£…å¤‡ç¢ç‰‡",
    probability: 0.199,
    items: ["è¡¥ç»™å‹èƒ½é‡æ ¸å¿ƒï¼ˆAçº§ï¼‰2ä¸ª","å˜²å¼„ç¢ç‰‡2ä¸ª","äº¤ç»‡å‡¶å…½æ‰£","é­…æƒ‘ç¢ç‰‡2ä¸ª","å‘å–Šç¢ç‰‡2ä¸ª","ç ´ç­ç¢ç‰‡2ä¸ª","æ¼†é»‘çš„BOSSé¥°å“ç¢ç‰‡","ç¥ç§˜æ²³æ°´æ»´çŸ³2ä¸ª","æ—¶é—´ç¢ç‰‡2ä¸ª","å¤ªåˆæ°´æ»´çŸ³2ä¸ª","ç‰¹æ®Šå‹èƒ½é‡æ ¸å¿ƒï¼ˆSçº§ï¼‰","æ­ªæ›²æ¬²æœ›ç»“æ™¶","é—ç•™çš„å¡å°”æ´›æ–¯æ„å¿—"]
  
    },
    {
        name: "æˆé•¿é“å…·",
    probability: 0.0966,
    items: ["10ä¸ªç´¢å°”è‰¾å°”è¾¾ç¢ç‰‡äº¤æ¢åˆ¸2ä¸ª","30ä¸ªæ ¸å¿ƒå®çŸ³äº¤æ¢åˆ¸","ç»éªŒä¹‹æ ¸å¿ƒå®çŸ³","ç»éªŒå€¼3å€åˆ¸ï¼ˆ30åˆ†é’Ÿï¼‰","ç»éªŒå€¼4å€åˆ¸ï¼ˆ30åˆ†é’Ÿï¼‰","å€¾å‘æˆé•¿ç§˜è¯","ç´¢å°”è‰¾å°”è¾¾/ç´¢å°”è‰¾å°”è¾¾ç¢ç‰‡é€‰æ‹©åˆ¸"]
  },
    {
        name: "å¼ºåŒ–é“å…·",
    probability: 0.3262,
    items: ["(é™å®š)æé™çªç ´5000ä¸‡é€‰æ‹©åˆ¸","(é™å®š)æé™çªç ´5äº¿é€‰æ‹©åˆ¸","1000ä¸‡æé™çªç ´çŸ³100%3ä¸ª","1000ä¸‡æé™çªç ´çŸ³50%5ä¸ª","1äº¿æé™çªç ´çŸ³100%","1äº¿æé™çªç ´çŸ³30%3ä¸ª","1äº¿æé™çªç ´çŸ³50%2ä¸ª","5äº¿æé™çªç ´çŸ³30%2ä¸ª","5äº¿æé™çªç ´çŸ³50%","Açº§æ½œèƒ½é™„åŠ å·è½´ 100%","Açº§æ½œèƒ½é™„åŠ å·è½´ 50%","Açº§æ½œèƒ½é™„åŠ å·è½´ 80%","Sçº§æ½œèƒ½é™„åŠ å·è½´ 30%","Sçº§æ½œèƒ½é™„åŠ å·è½´ 60%","Sçº§æ½œèƒ½é™„åŠ å·è½´ 80%","å® ç‰©è£…å¤‡çº¯ç™½å·è½´100%","å® ç‰©è£…å¤‡è¿˜åŸå·è½´100%","é™„åŠ Açº§æ½œèƒ½é™„åŠ å·è½´100%","é™„åŠ Açº§æ½œèƒ½é™„åŠ å·è½´30%","é™„åŠ Sçº§æ½œèƒ½é™„åŠ å·è½´30%","é™„åŠ Sçº§æ½œèƒ½é™„åŠ å·è½´50%","é»‘æš—æ¶…æ§ƒç«ç„°2ä¸ª","é‡‘å…‰æ½œèƒ½é™„åŠ å°ç« ","å¼ºå¤§çš„æ¶…æ§ƒç«ç„°2ä¸ª","å®Œç¾é™„åŠ åˆ»å°ä¹‹å°","æ˜Ÿä¹‹åŠ›10æ˜Ÿå¼ºåŒ–åˆ¸","æ˜Ÿä¹‹åŠ›11æ˜Ÿå¼ºåŒ–åˆ¸","æ˜Ÿä¹‹åŠ›12æ˜Ÿå¼ºåŒ–åˆ¸","æ˜Ÿä¹‹åŠ›13æ˜Ÿå¼ºåŒ–åˆ¸","æ˜Ÿä¹‹åŠ›14æ˜Ÿå¼ºåŒ–åˆ¸","æ˜Ÿä¹‹åŠ›15æ˜Ÿå¼ºåŒ–åˆ¸","æ˜Ÿä¹‹åŠ›16æ˜Ÿå¼ºåŒ–åˆ¸","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸100%ï¼ˆ16æ˜Ÿä¸ºæ­¢ï¼‰","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸100%ï¼ˆ17æ˜Ÿä¸ºæ­¢ï¼‰","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸100%ï¼ˆ18æ˜Ÿä¸ºæ­¢ï¼‰","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸30%ï¼ˆ16æ˜Ÿä¸ºæ­¢ï¼‰","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸30%ï¼ˆ17æ˜Ÿä¸ºæ­¢ï¼‰","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸30%ï¼ˆ18æ˜Ÿä¸ºæ­¢ï¼‰","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸50%ï¼ˆ16æ˜Ÿä¸ºæ­¢ï¼‰","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸50%ï¼ˆ17æ˜Ÿä¸ºæ­¢ï¼‰","æ˜Ÿä¹‹åŠ›1æ˜Ÿçªç ´å¼ºåŒ–åˆ¸50%ï¼ˆ18æ˜Ÿä¸ºæ­¢ï¼‰","é“¶å…‰æ½œèƒ½é™„åŠ å°ç« ","æ°¸è¿œçš„æ¶…æ§ƒç«ç„°2ä¸ª"]
  },
  {
        name: "çµé­‚ç¢ç‰‡",
    probability: 0.1223,
    items: ["é˜¿å¡ä¼Šå‹’çµé­‚ç¢å—5ä¸ª","ç­Â·é›·æ˜‚çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","åŠåŠçµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","è´ä¼¦çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","è™è æ€ªçµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","æˆ´ç±³å®‰çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","æ•¦å‡¯å°”çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","æ­¼ç­å…µå™¨æ–¯ä¹Œçµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","è§‰é†’å¸Œæ‹‰çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","å¡å°”æ´›æ–¯çµé­‚ç¢ç‰‡5ä¸ª","å¡ç³çš„çµé­‚ç¢ç‰‡5ä¸ª","æ—æ³¢çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","è·¯è¥¿å¾·çš„çµé­‚ç¢ç‰‡5ä¸ª","éº¦æ ¼çº³æ–¯çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","çš®åŸƒå°”çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","å“å…‹ç¼¤çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","æ–¯ä¹Œçµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","å¨å°”çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","å¸Œæ‹‰çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","å¸Œçº³æ–¯çµé­‚ç¢å—5ä¸ª","è¡€è…¥å¥³ç‹çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª","æ‰æ˜†çµé­‚ç»“æ™¶ç¢ç‰‡5ä¸ª"]
  },
  {
        name: "é«˜çº§è£…å¤‡",
    probability: 0.2032,
    items: ["åŸƒè‹è±å¸ƒæ–¯ESPé™åˆ¶å™¨","åŸƒè‹è±å¸ƒæ–¯é•¿æ–","åŸƒè‹è±å¸ƒæ–¯ç©¿é€çŸ›","åŸƒè‹è±å¸ƒæ–¯å¤§é”¤","åŸƒè‹è±å¸ƒæ–¯å¤§æ–§","åŸƒè‹è±å¸ƒæ–¯å¤§ç‚®","åŸƒè‹è±å¸ƒæ–¯è°ƒè°å™¨","åŸƒè‹è±å¸ƒæ–¯çŸ­æ–","åŸƒè‹è±å¸ƒæ–¯æ³•å¸ˆæŠ¤è‚©","åŸƒè‹è±å¸ƒæ–¯æ³•å¸ˆå¸½","åŸƒè‹è±å¸ƒæ–¯æ³•å¸ˆæ‰‹å¥—","åŸƒè‹è±å¸ƒæ–¯æ³•å¸ˆé‹","åŸƒè‹è±å¸ƒæ–¯é£ä¾ æŠ¤è‚©","åŸƒè‹è±å¸ƒæ–¯é£ä¾ å¸½","åŸƒè‹è±å¸ƒæ–¯é£ä¾ æŠ«é£","åŸƒè‹è±å¸ƒæ–¯é£ä¾ æ‰‹å¥—","åŸƒè‹è±å¸ƒæ–¯é£ä¾ å¥—è£…","åŸƒè‹è±å¸ƒæ–¯é£ä¾ é‹","åŸƒè‹è±å¸ƒæ–¯å¤ä»‡æ–—æ‹³","åŸƒè‹è±å¸ƒæ–¯å¼“","åŸƒè‹è±å¸ƒæ–¯å¼“ç®­æ‰‹æŠ¤è‚©","åŸƒè‹è±å¸ƒæ–¯å¼“ç®­æ‰‹å¸½","åŸƒè‹è±å¸ƒæ–¯å¼“ç®­æ‰‹æŠ«é£","åŸƒè‹è±å¸ƒæ–¯å¼“ç®­æ‰‹æ‰‹å¥—","åŸƒè‹è±å¸ƒæ–¯å¼“ç®­æ‰‹å¥—è£…","åŸƒè‹è±å¸ƒæ–¯å¼“ç®­æ‰‹é‹","åŸƒè‹è±å¸ƒæ–¯æ€ªæ‰‡","åŸƒè‹è±å¸ƒæ–¯æµ·ç›—æŠ¤è‚©","åŸƒè‹è±å¸ƒæ–¯æµ·ç›—å¸½","åŸƒè‹è±å¸ƒæ–¯æµ·ç›—æŠ«é£","åŸƒè‹è±å¸ƒæ–¯æµ·ç›—æ‰‹å¥—","åŸƒè‹è±å¸ƒæ–¯æµ·ç›—å¥—è£…","åŸƒè‹è±å¸ƒæ–¯æµ·ç›—é‹","åŸƒè‹è±å¸ƒæ–¯ç¯åˆƒ","åŸƒè‹è±å¸ƒæ–¯è®°å¿†é•¿æ–","åŸƒè‹è±å¸ƒæ–¯ç²¾å","åŸƒè‹è±å¸ƒæ–¯å·¨çµå¼€å±±æ–§","åŸƒè‹è±å¸ƒæ–¯å†›åˆ€","åŸƒè‹è±å¸ƒæ–¯å®½å¤§åˆ€","åŸƒè‹è±å¸ƒæ–¯é›·ç¥","åŸƒè‹è±å¸ƒæ–¯çµé­‚æ‰‹é“³","åŸƒè‹è±å¸ƒæ–¯é¾™æ¯è‡‚ç®­","åŸƒè‹è±å¸ƒæ–¯é­”æ³•å¸ˆæŠ«é£","åŸƒè‹è±å¸ƒæ–¯é­”æ³•å¸ˆå¥—è£…","åŸƒè‹è±å¸ƒæ–¯é­”åŠ›æ‰‹å¥—","åŸƒè‹è±å¸ƒæ–¯èƒ½é‡å‰‘","åŸƒè‹è±å¸ƒæ–¯å¼©","åŸƒè‹è±å¸ƒæ–¯éª‘å£«æŠ¤è‚©","åŸƒè‹è±å¸ƒæ–¯éª‘å£«æŠ«é£","åŸƒè‹è±å¸ƒæ–¯éª‘å£«æ‰‹å¥—","åŸƒè‹è±å¸ƒæ–¯éª‘å£«å¥—è£…","åŸƒè‹è±å¸ƒæ–¯éª‘å£«å¤´ç›”","åŸƒè‹è±å¸ƒæ–¯éª‘å£«é‹","åŸƒè‹è±å¸ƒæ–¯æª","åŸƒè‹è±å¸ƒæ–¯æ‹³å°","åŸƒè‹è±å¸ƒæ–¯æ‹³ç”²","åŸƒè‹è±å¸ƒæ–¯æ‰‡å­","åŸƒè‹è±å¸ƒæ–¯åŒå¼©æª","åŸƒè‹è±å¸ƒæ–¯åŒå¤´æ–","åŸƒè‹è±å¸ƒæ–¯é”é“¾","åŸƒè‹è±å¸ƒæ–¯å± é¾™æ–©","åŸƒè‹è±å¸ƒæ–¯äº¡å‘½å‰‘","åŸƒè‹è±å¸ƒæ–¯æ­¦å£«åˆ€","åŸƒè‹è±å¸ƒæ–¯è¿œå¤å¼“","åŸƒè‹è±å¸ƒæ–¯æˆ˜é”¤","åŸƒè‹è±å¸ƒæ–¯æˆ˜æ–§","åŸƒè‹è±å¸ƒæ–¯æŠ˜å æ‰‹æ–","åŸƒè‹è±å¸ƒæ–¯ä¹‹åˆƒ","é«˜çº§è´å‹’å¾·è€³ç¯","é«˜çº§è´å‹’å¾·æˆ’æŒ‡","é«˜çº§è´å‹’å¾·åˆ»å°åŠå ","é«˜çº§è´å‹’å¾·åˆ»å°è…°å¸¦","ç¥ç§˜ä¹‹å½±ESPé™åˆ¶å™¨","ç¥ç§˜ä¹‹å½±åŒ•é¦–","ç¥ç§˜ä¹‹å½±è‰æ‰‡","ç¥ç§˜ä¹‹å½±é•¿æª","ç¥ç§˜ä¹‹å½±é•¿æ–","ç¥ç§˜ä¹‹å½±é”¤","ç¥ç§˜ä¹‹å½±å•æ‰‹å‰‘","ç¥ç§˜ä¹‹å½±è°ƒè°å™¨","ç¥ç§˜ä¹‹å½±çŸ­æª","ç¥ç§˜ä¹‹å½±çŸ­æ–","ç¥ç§˜ä¹‹å½±æ³•å¸ˆæŠ¤è‚©","ç¥ç§˜ä¹‹å½±æ³•å¸ˆå¸½","ç¥ç§˜ä¹‹å½±æ³•å¸ˆæŠ«é£","ç¥ç§˜ä¹‹å½±æ³•å¸ˆæ‰‹å¥—","ç¥ç§˜ä¹‹å½±æ³•å¸ˆå¥—è£…","ç¥ç§˜ä¹‹å½±æ³•å¸ˆé‹","ç¥ç§˜ä¹‹å½±é£ä¾ æŠ¤è‚©","ç¥ç§˜ä¹‹å½±é£ä¾ å¸½","ç¥ç§˜ä¹‹å½±é£ä¾ æŠ«é£","ç¥ç§˜ä¹‹å½±é£ä¾ æ‰‹å¥—","ç¥ç§˜ä¹‹å½±é£ä¾ å¥—è£…","ç¥ç§˜ä¹‹å½±é£ä¾ é‹","ç¥ç§˜ä¹‹å½±æ–§","ç¥ç§˜ä¹‹å½±å¼“","ç¥ç§˜ä¹‹å½±å¼“ç®­æ‰‹æŠ¤è‚©","ç¥ç§˜ä¹‹å½±å¼“ç®­æ‰‹å¸½","ç¥ç§˜ä¹‹å½±å¼“ç®­æ‰‹æŠ«é£","ç¥ç§˜ä¹‹å½±å¼“ç®­æ‰‹æ‰‹å¥—","ç¥ç§˜ä¹‹å½±å¼“ç®­æ‰‹å¥—è£…","ç¥ç§˜ä¹‹å½±å¼“ç®­æ‰‹é‹","ç¥ç§˜ä¹‹å½±æ”»åŸç‚®","ç¥ç§˜ä¹‹å½±æµ·ç›—æŠ¤è‚©","ç¥ç§˜ä¹‹å½±æµ·ç›—å¸½","ç¥ç§˜ä¹‹å½±æµ·ç›—æŠ«é£","ç¥ç§˜ä¹‹å½±æµ·ç›—æ‰‹å¥—","ç¥ç§˜ä¹‹å½±æµ·ç›—å¥—è£…","ç¥ç§˜ä¹‹å½±æµ·ç›—é‹","ç¥ç§˜ä¹‹å½±ç¯åˆƒ","ç¥ç§˜ä¹‹å½±æœºç”²æª","ç¥ç§˜ä¹‹å½±è®°å¿†é•¿æ–","ç¥ç§˜ä¹‹å½±ç²¾å","ç¥ç§˜ä¹‹å½±çµé­‚æ‰‹é“³","ç¥ç§˜ä¹‹å½±é¾™æ¯è‡‚ç®­","ç¥ç§˜ä¹‹å½±çŸ›","ç¥ç§˜ä¹‹å½±é­”åŠ›æ‰‹å¥—","ç¥ç§˜ä¹‹å½±èƒ½é‡å‰‘","ç¥ç§˜ä¹‹å½±å¼©","ç¥ç§˜ä¹‹å½±æ‹³å°","ç¥ç§˜ä¹‹å½±æ‹³å¥—","ç¥ç§˜ä¹‹å½±åˆƒ","ç¥ç§˜ä¹‹å½±æ‰‹æ–","ç¥ç§˜ä¹‹å½±åŒå¼©æª","ç¥ç§˜ä¹‹å½±åŒæ‰‹é”¤","ç¥ç§˜ä¹‹å½±åŒæ‰‹å‰‘","ç¥ç§˜ä¹‹å½±åŒæ‰‹æˆ˜æ–§","ç¥ç§˜ä¹‹å½±åŒå¤´æ–","ç¥ç§˜ä¹‹å½±é”é“¾","ç¥ç§˜ä¹‹å½±äº¡å‘½å‰‘","ç¥ç§˜ä¹‹å½±æ­¦å£«åˆ€","ç¥ç§˜ä¹‹å½±å¹¸è¿é“å…·å·è½´","ç¥ç§˜ä¹‹å½±è¿œå¤å¼“","ç¥ç§˜ä¹‹å½±æˆ˜å£«æŠ¤è‚©","ç¥ç§˜ä¹‹å½±æˆ˜å£«å¸½","ç¥ç§˜ä¹‹å½±æˆ˜å£«æŠ«é£","ç¥ç§˜ä¹‹å½±æˆ˜å£«æ‰‹å¥—","ç¥ç§˜ä¹‹å½±æˆ˜å£«å¥—è£…","ç¥ç§˜ä¹‹å½±æˆ˜å£«é‹","ç¥ç§˜ä¹‹å½±æŠ˜æ‰‡","ç¥ç§˜ä¹‹å½±æŒ‡èŠ‚","æ— å°½è¾‰è€€æ³•å¸ˆæŠ¤è‚©","æ— å°½è¾‰è€€é£ä¾ è¡¬è¡«","æ— å°½è¾‰è€€é£ä¾ æŠ¤è‚©","æ— å°½è¾‰è€€é£ä¾ è£¤","æ— å°½è¾‰è€€é£ä¾ æŠ«é£","æ— å°½è¾‰è€€é£ä¾ æ‰‹å¥—","æ— å°½è¾‰è€€é£ä¾ å¤´å·¾","æ— å°½è¾‰è€€é£ä¾ é‹","æ— å°½è¾‰è€€å¼“ç®­æ‰‹æ–—ç¯·","æ— å°½è¾‰è€€å¼“ç®­æ‰‹æŠ¤è‚©","æ— å°½è¾‰è€€å¼“ç®­æ‰‹è£¤","æ— å°½è¾‰è€€å¼“ç®­æ‰‹å¸½","æ— å°½è¾‰è€€å¼“ç®­æ‰‹æŠ«é£","æ— å°½è¾‰è€€å¼“ç®­æ‰‹æ‰‹å¥—","æ— å°½è¾‰è€€å¼“ç®­æ‰‹é‹","æ— å°½è¾‰è€€æµ·ç›—å¤§è¡£","æ— å°½è¾‰è€€æµ·ç›—æŠ¤è‚©","æ— å°½è¾‰è€€æµ·ç›—è£¤","æ— å°½è¾‰è€€æµ·ç›—å¸½","æ— å°½è¾‰è€€æµ·ç›—æŠ«é£","æ— å°½è¾‰è€€æµ·ç›—æ‰‹å¥—","æ— å°½è¾‰è€€æµ·ç›—é‹","æ— å°½è¾‰è€€é­”æ³•å¸ˆé•¿è¢","æ— å°½è¾‰è€€é­”æ³•å¸ˆè£¤","æ— å°½è¾‰è€€é­”æ³•å¸ˆå¸½","æ— å°½è¾‰è€€é­”æ³•å¸ˆæ‰‹å¥—","æ— å°½è¾‰è€€é­”æ³•å¸ˆé‹","æ— å°½è¾‰è€€éª‘å£«æŠ¤è‚©","æ— å°½è¾‰è€€éª‘å£«è£¤","æ— å°½è¾‰è€€éª‘å£«ç›”ç”²","æ— å°½è¾‰è€€éª‘å£«æŠ«é£","æ— å°½è¾‰è€€éª‘å£«æ‰‹å¥—","æ— å°½è¾‰è€€éª‘å£«å¤´ç›”","æ— å°½è¾‰è€€éª‘å£«é‹","æ— å°½è¾‰è€€è€…é­”æ³•å¸ˆæŠ«é£"]
  },
    {
        name: "å…¶ä»–ç‰©å“",
        probability: 0.0527,
        items: [
            { name: "å¹¸è¿ç™½é‡‘å®ç‰©ç®±", isTreasureBox: true, openCategory: "ç™½é‡‘å®ç®±å¥–åŠ±" },
            { name: "å¹¸è¿ç’€ç’¨å®ç‰©ç®±", isTreasureBox: true, openCategory: "ç’€ç’¨å®ç®±å¥–åŠ±" },
            "å°å°è§£é™¤å·è½´",
            "100%å·è½´40æ ¼èƒŒåŒ…",
            "çµé­‚ç»“æ™¶40æ ¼èƒŒåŒ…",
            "é…æ–¹40æ ¼èƒŒåŒ…",
            "æ™ºèƒ½æœºå™¨äººå•†åº—ä½¿ç”¨åˆ¸ï¼ˆ30å¤©ï¼‰"
        ]
    },
    
    {
        name: "ç™½é‡‘å®ç®±å¥–åŠ±",
        probability: 1.0,
        subCategories: [
            {
                name: "å¼ºåŒ–é“å…·",
                probability: 0.3155,
                items: [
                    "10äº¿æé™çªç ´çŸ³",
                    "é™„åŠ Sçº§æ½œèƒ½é™„åŠ å·è½´100%",
                    "æ·±æ¸Šçš„æ¶…æ§ƒç«ç„°50ä¸ª",
                    "æ˜Ÿä¹‹åŠ›15æ˜Ÿå¼ºåŒ–åˆ¸",
                    "æ˜Ÿä¹‹åŠ›16æ˜Ÿå¼ºåŒ–åˆ¸",
                    "æ˜Ÿä¹‹åŠ›17æ˜Ÿå¼ºåŒ–åˆ¸"
                ]
            },
            {
                name: "é«˜çº§è£…å¤‡",
                probability: 0.5130,
                items: [
                    "4çº§æš´å‡»ä¼¤å®³æˆ’æŒ‡äº¤æ¢åˆ¸",
                    "4çº§é£é™©ä¹‹æˆ’äº¤æ¢åˆ¸",
                    "4çº§é›†æˆä¹‹æˆ’äº¤æ¢åˆ¸",
                    "ç²‰è‰²åœ£æ¯",
                    "æ„¤æ€’çš„æ‰æ˜†è…°å¸¦",
                    "çš‡å®¶é»‘è‰²é‡‘å±æŠ¤è‚©",
                    "æ°´æ™¶å¹¸è¿å¾½ç« "
                ]
            },
            {
                name: "ä¼Ÿå¤§çµé­‚",
                probability: 0.1715,
                items: [
                    "ä¼Ÿå¤§çš„é˜¿å¡ä¼Šå‹’çµé­‚ç»“æ™¶",
                    "ä¼Ÿå¤§çš„ç­Â·é›·æ˜‚çµé­‚ç»“æ™¶",
                    "ä¼Ÿå¤§çš„è™è æ€ªçµé­‚ç»“æ™¶",
                    "ä¼Ÿå¤§çš„å“å…‹ç¼¤çµé­‚ç»“æ™¶",
                    "ä¼Ÿå¤§çš„æ‰æ˜†çµé­‚ç»“æ™¶"
                ]
            }
        ]
    },
    {
        name: "ç’€ç’¨å®ç®±å¥–åŠ±",
        probability: 1.0,
        subCategories: [
            {
                name: "å¼ºåŒ–é“å…·",
                probability: 0.4097,
                items: [
                    "(é™å®š)æé™çªç ´20äº¿é€‰æ‹©åˆ¸5ä¸ª",
                    "é™„åŠ Sçº§æ½œèƒ½é™„åŠ å·è½´100%",
                    "æ·±æ¸Šçš„æ¶…æ§ƒç«ç„°100ä¸ª",
                    "æ˜Ÿä¹‹åŠ›16æ˜Ÿå¼ºåŒ–åˆ¸",
                    "æ˜Ÿä¹‹åŠ›17æ˜Ÿå¼ºåŒ–åˆ¸",
                    "æ˜Ÿä¹‹åŠ›18æ˜Ÿå¼ºåŒ–åˆ¸"
                ]
            },
            {
                name: "é«˜çº§è£…å¤‡",
                probability: 0.5069,
                items: [
                    "4çº§æŒç»­ä¹‹æˆ’äº¤æ¢åˆ¸",
                    "4çº§å…‹åˆ¶ä¹‹æˆ’äº¤æ¢åˆ¸",
                    "4çº§æ­¦å™¨å¢ç›Šé€‰æ‹©ç®±",
                    "è‰¾æ–¯æ³°æ‹‰è€³ç¯",
                    "æ‹‚æ™“åŠå ",
                    "é»æ˜ä¹‹å®ˆæŠ¤å¤©ä½¿æˆ’æŒ‡",
                    "æš®å…‰ç¥ç¦æ ‡è®°",
                    "ç¥ç§˜ä¹‹å½±é˜²å…·ç®±",
                    "ç¥ç§˜ä¹‹å½±æ­¦å™¨ç®±",
                    "æœ€é«˜çº§è´å‹’å¾·è€³ç¯",
                    "æœ€é«˜çº§è´å‹’å¾·æˆ’æŒ‡"
                ]
            },
            {
                name: "ä¼Ÿå¤§çµé­‚",
                probability: 0.0833,
                items: [
                    "ä¼Ÿå¤§çš„æ­¼ç­å…µå™¨æ–¯ä¹Œçµé­‚ç»“æ™¶",
                    "ä¼Ÿå¤§çš„å¡å°”æ´›æ–¯çµé­‚",
                    "ä¼Ÿå¤§çš„å¡ç³çµé­‚",
                    "ä¼Ÿå¤§çš„æ—æ³¢çµé­‚ç»“æ™¶"
                ]
            }
        ]
    }
];

let isDrawing = false;
let attempts = 0;
let stats = {};
let chart = null;

// åˆå§‹åŒ–ç›®æ ‡é€‰é¡¹
function initTargets() {
    const container = document.getElementById('targetItems');
    const allItems = deepScanCategories(categories);
    
    container.innerHTML = allItems.filter(item => !item.isTreasureBox).map(item => `
        <div class="form-check">
            <input class="form-check-input" type="checkbox" value="${item.name}" 
                   id="${item.name}" ${item.probability < 0.01 ? 'disabled' : ''}>
            <label class="form-check-label" for="${item.name}">
                ${item.name} 
                ${item.probability < 0.01 ? 'âœ¨' : ''}
            </label>
        </div>
    `).join('');
}

// é€’å½’æ‰«ææ‰€æœ‰é“å…·
function deepScanCategories(catList, path = [], result = []) {
    for (const category of catList) {
        const newPath = [...path, category.name];
        if (category.subCategories) {
            deepScanCategories(category.subCategories, newPath, result);
        }
        if (category.items) {
            category.items.forEach(item => {
                const isBox = typeof item === 'object' && item.isTreasureBox;
                result.push({
                    name: typeof item === 'string' ? item : item.name,
                    probability: calculateProbability(newPath, item),
                    isTreasureBox: isBox,
                    path: [...newPath]
                });
            });
        }
    }
    return result;
}

// è®¡ç®—å®é™…æ¦‚ç‡
function calculateProbability(path, item) {
    let probability = 1;
    let currentLevel = categories;
    
    for (const levelName of path) {
        const currentCat = currentLevel.find(c => c.name === levelName);
        probability *= currentCat.probability;
        if (currentCat.subCategories) {
            currentLevel = currentCat.subCategories;
        }
    }
    
    if (typeof item === 'object') {
        const parentCat = currentLevel.find(c => c.items.includes(item));
        probability *= parentCat.probability;
    }
    
    return probability;
}

// é€’å½’æŠ½å¥–æ ¸å¿ƒé€»è¾‘
function drawItem(currentCategories = categories) {
    const rand = Math.random();
    let accumulated = 0;

    for (const category of currentCategories) {
        accumulated += category.probability;
        if (rand <= accumulated) {
            if (category.subCategories) {
                return drawItem(category.subCategories);
            }
            
            const item = category.items[Math.floor(Math.random() * category.items.length)];
            if (typeof item === 'object' && item.isTreasureBox) {
                const treasureCat = categories.find(c => c.name === item.openCategory);
                return {
                    name: item.name,
                    subItem: drawItem(treasureCat.subCategories),
                    isTreasureBox: true
                };
            }
            return typeof item === 'string' ? item : item.name;
        }
    }
    return 'æœªä¸­å¥–';
}

// å¤„ç†æŠ½å¥–ç»“æœ
function processResult(result) {
    let finalItem = result;
    const path = [];
    
    while (typeof finalItem === 'object') {
        path.push(finalItem.name);
        finalItem = finalItem.subItem;
    }
    path.push(finalItem);
    
    return {
        finalItem,
        path: path.join(' â†’ ')
    };
}

async function startDrawing() {
    if (isDrawing) return;
    
    const targets = getSelectedTargets();
    if (targets.length === 0) {
        alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªç›®æ ‡é“å…·ï¼');
        return;
    }

    isDrawing = true;
    toggleControls(true);
    attempts = 0;
    stats = {};
    
    while (isDrawing) {
        const rawResult = drawItem();
        const { finalItem, path } = processResult(rawResult);
        attempts++;
        
        // æ›´æ–°ç»Ÿè®¡
        stats[finalItem] = (stats[finalItem] || 0) + 1;
        
        // æ›´æ–°æ˜¾ç¤º
        addLogEntry(path);
        updateProgress();
        
        // å‘½ä¸­æ£€æµ‹
        if (targets.includes(finalItem)) {
            showSuccess(finalItem);
            if (!document.getElementById('autoContinue').checked) {
                stopDrawing();
                break;
            }
        }
        
        // æ€§èƒ½ä¼˜åŒ–
        if (attempts % 100 === 0) {
            updateChart();
            await new Promise(resolve => setTimeout(resolve, 0));
        }
    }
}

// ç•Œé¢æ›´æ–°å‡½æ•°
function addLogEntry(path) {
    const log = document.getElementById('resultLogs');
    const entry = document.createElement('div');
    entry.className = 'log-entry';
    entry.innerHTML = `<span class="text-muted">#${attempts}</span> ${path}`;
    log.prepend(entry);
}

function updateProgress() {
    document.getElementById('attemptCount').textContent = attempts;
    const progress = Math.min(100, (attempts % 1000) / 10);
    document.querySelector('.progress-bar').style.width = `${progress}%`;
}

function showSuccess(item) {
    const log = document.getElementById('resultLogs');
    const entry = document.createElement('div');
    entry.className = 'log-entry';
    entry.innerHTML = `
        <div class="alert alert-success mt-2">
            ğŸ‰ æˆåŠŸè·å¾— ã€${item}ã€‘! æ€»è®¡å°è¯•æ¬¡æ•°: ${attempts}
        </div>
    `;
    log.prepend(entry);
}

// å›¾è¡¨ç›¸å…³
function updateChart() {
    const items = Object.entries(stats)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 20);

    if (!chart) {
        const ctx = document.getElementById('frequencyChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: items.map(i => i[0]),
                datasets: [{
                    label: 'å‡ºç°æ¬¡æ•°',
                    data: items.map(i => i[1]),
                    backgroundColor: '#3498db'
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true },
                    x: { ticks: { autoSkip: false, maxRotation: 45 } }
                }
            }
        });
    } else {
        chart.data.labels = items.map(i => i[0]);
        chart.data.datasets[0].data = items.map(i => i[1]);
        chart.update();
    }
}

// è¾…åŠ©å‡½æ•°
function getSelectedTargets() {
    return [...document.querySelectorAll('input[type="checkbox"]:checked')].map(c => c.value);
}

function toggleControls(running) {
    document.getElementById('startBtn').disabled = running;
    document.getElementById('stopBtn').disabled = !running;
}

function stopDrawing() {
    isDrawing = false;
    toggleControls(false);
    updateChart();
}

// åˆå§‹åŒ–
window.onload = () => {
    initTargets();
    updateChart();
};
</script>
</body>
</html>
