<!DOCTYPE html>
<html lang="zh-CN">
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b52ffcdf33a045f844b6558bb382a915";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<head>
    <meta charset="UTF-8">
    <title>å†’é™©å²›æ€ªæ€ªå¡æ¨¡æ‹Ÿå™¨</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        synthesis-panel {
            background: #fff3e0;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }
        .inventory {
            display: flex;
            gap: 15px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .inventory-item {
            background: #ffe0b2;
            padding: 10px 15px;
            border-radius: 8px;
            min-width: 70px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        :root {
            --primary: #6c5ce7;
            --secondary: #a8a5e6;
            --success: #00b894;
            --danger: #ff7675;
            --warning: #f9c74f;
            --background: #f8f9fa;
        }

        body {
            font-family: 'Poppins', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: var(--background);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary);
        }

        .control-panel {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        select, input {
            padding: 10px;
            border: 2px solid var(--secondary);
            border-radius: 8px;
            background: white;
        }

        .results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 30px;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .card h3 {
            margin-top: 0;
            color: var(--primary);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .combination-table tr:nth-child(odd) {
            background: #f8f9ff;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            color: var(--primary);
            margin: 10px 0;
        }

        .probability-table {
            margin-top: 30px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ´ å†’é™©å²›æ€ªæ€ªå¡æ¨¡æ‹Ÿå™¨</h1>
        <h4 style="text-align: center; margin-bottom: 5px;">    by ç´«ç”µNS
            <a href="https://photonrain.github.io/" class="ms-3" style="color: #3498db; text-decoration: none;">ç½‘ç«™é¦–é¡µ</a>
        <h4 style="text-align: center; margin-bottom: 5px;">    å“è´¨æ¦‚ç‡ç»Ÿè®¡äº†300ä½™æ¬¡æŠ½å¡ç»“æœå¾—åˆ° 
    </div>

    <div class="control-panel">
        <div class="controls">
            <button class="btn-primary" onclick="draw(1)">âœ¨ å•æŠ½</button>
            <button class="btn-primary" onclick="draw(10)">ğŸ åè¿æŠ½</button>
            <button class="btn-primary" onclick="draw(100)">ğŸ‰ ç™¾è¿æŠ½</button>
            <button class="btn-warning" id="fastModeBtn" onclick="toggleFastMode()">ğŸš€ æé€Ÿæ¨¡å¼</button>
            <select id="targetType">
                <option value="any">ä»»æ„ç±»å‹</option>
                <option value="æ™®é€š">æ™®é€š</option>
                <option value="ç‰¹æ®Š">ç‰¹æ®Š</option>
                <option value="å‚²å¤©">å‚²å¤©</option>
            </select>
            <select id="targetQuality">
                <option value="any">ä»»æ„å“è´¨</option>
                
                <option value="A">Açº§</option>
                <option value="S">Sçº§</option>
                <option value="SS">SSçº§</option>
            </select>
            <button class="btn-primary" onclick="startTargetDraw()">ğŸ¯ æŠ½åˆ°ç›®æ ‡</button>
            <button class="btn-danger" onclick="stopDrawing()">â¹ åœæ­¢</button>
            <button class="btn-danger" onclick="resetData()">ğŸ”„ é‡ç½®</button>
            <input type="number" id="costPerDraw" value="2.6" placeholder="å•æŠ½ä»·æ ¼">
        </div>

        <div class="stats">
            <div class="stat-box">
                <div>æ€»æŠ½å–æ¬¡æ•°</div>
                <div class="stat-value" id="totalDraws">0</div>
            </div>
            <div class="stat-box">
                <div>æ¶ˆè€—é‡‘å¸</div>
                <div class="stat-value" id="totalCost">0</div>
            </div>
        </div>
        <!-- æ–°å¢åˆæˆé¢æ¿ -->
        <div class="synthesis-panel" id="synthesisPanel" style="display:none;">
            <div style="margin-bottom: 10px;">
                <button class="btn-warning" onclick="toggleAutoSynthesis()" id="autoSynthesisBtn">âš™ï¸ å¯ç”¨è‡ªåŠ¨åˆæˆ</button>
            </div>
            <div class="inventory">
                <div class="inventory-item">
                    <div>Bçº§å‚²å¤©</div>
                    <div id="inventoryB">0</div>
                </div>
                <div class="inventory-item">
                    <div>Açº§å‚²å¤©</div>
                    <div id="inventoryA">0</div>
                </div>
                <div class="inventory-item">
                    <div>Sçº§å‚²å¤©</div>
                    <div id="inventoryS">0</div>
                </div>
                <div class="inventory-item">
                    <div>SSçº§å‚²å¤©</div>
                    <div id="inventorySS">0</div>
                </div>
            </div>
        </div>
    </div>

    <div class="results">
        <div class="card" id="recentCard">
            <h3>ğŸ“ æœ€è¿‘æŠ½å–è®°å½• (æœ€æ–°10æ¡)</h3>
            <table id="recentResults">
                <tr><th>ç±»å‹</th><th>å“è´¨</th><th>æ—¶é—´</th></tr>
            </table>
        </div>
        <div class="card">
            <h3>ğŸ“Š ç»„åˆç»Ÿè®¡è¡¨</h3>
            <table class="combination-table">
                <tr><th>ç±»å‹</th><th>å“è´¨</th><th>å‡ºç°æ¬¡æ•°</th></tr>
                <!-- æ™®é€šç³»åˆ— -->
                <tr id="æ™®é€šB"><td>æ™®é€š</td><td>B</td><td>0</td></tr>
                <tr id="æ™®é€šA"><td>æ™®é€š</td><td>A</td><td>0</td></tr>
                <tr id="æ™®é€šS"><td>æ™®é€š</td><td>S</td><td>0</td></tr>
                <tr id="æ™®é€šSS"><td>æ™®é€š</td><td>SS</td><td>0</td></tr>
                <!-- ç‰¹æ®Šç³»åˆ— -->
                <tr id="ç‰¹æ®ŠB"><td>ç‰¹æ®Š</td><td>B</td><td>0</td></tr>
                <tr id="ç‰¹æ®ŠA"><td>ç‰¹æ®Š</td><td>A</td><td>0</td></tr>
                <tr id="ç‰¹æ®ŠS"><td>ç‰¹æ®Š</td><td>S</td><td>0</td></tr>
                <tr id="ç‰¹æ®ŠSS"><td>ç‰¹æ®Š</td><td>SS</td><td>0</td></tr>
                <!-- å‚²å¤©ç³»åˆ— -->
                
                <tr id="å‚²å¤©A"><td>å‚²å¤©</td><td>A</td><td>0</td></tr>
                <tr id="å‚²å¤©S"><td>å‚²å¤©</td><td>S</td><td>0</td></tr>
                <tr id="å‚²å¤©SS"><td>å‚²å¤©</td><td>SS</td><td>0</td></tr>
            </table>
        </div>
    </div>

    <div class="probability-table">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
            <div>
                <h3>ğŸ”– ç±»å‹æ¦‚ç‡è¡¨</h3>
                <table>
                    <tr><th>ç±»å‹</th><th>æ¦‚ç‡</th></tr>
                    <tr><td>æ™®é€šæ€ªæ€ª</td><td>98.794%</td></tr>
                    <tr><td>ç‰¹æ®Šæ€ªæ€ª</td><td>1.2%</td></tr>
                    <tr><td>å‚²å¤©æ€ªæ€ª</td><td>0.006%</td></tr>
                </table>
            </div>
            <div>
                <h3>ğŸ·ï¸ å“è´¨æ¦‚ç‡è¡¨</h3>
                <table>
                    <tr><th>å“è´¨</th><th>æ¦‚ç‡</th></tr>
                    <tr><td>B</td><td>40.6349%</td></tr>
                    <tr><td>A</td><td>51.746%</td></tr>
                    <tr><td>S</td><td>6.6667%</td></tr>
                    <tr><td>SS</td><td>0.9524%</td></tr>
                </table>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            updateSynthesisVisibility();
        });
        let isDrawing = false;
        let totalDraws = 0;
        let isFastMode = false;
        let costPerDraw = 1000;
        let allResults = [];
        
        const combinationStats = {
            'æ™®é€šB': { count: 0 },
            'æ™®é€šA': { count: 0 },
            'æ™®é€šS': { count: 0 },
            'æ™®é€šSS': { count: 0 },
            'ç‰¹æ®ŠB': { count: 0 },
            'ç‰¹æ®ŠA': { count: 0 },
            'ç‰¹æ®ŠS': { count: 0 },
            'ç‰¹æ®ŠSS': { count: 0 },
            'å‚²å¤©B': { count: 0 },
            'å‚²å¤©A': { count: 0 },
            'å‚²å¤©S': { count: 0 },
            'å‚²å¤©SS': { count: 0 }
        };
        // æ–°å¢åˆæˆç›¸å…³å˜é‡
        let isAutoSynthesis = false;
        let inventory = { B: 0, A: 0, S: 0, SS: 0 };
        let synthesizedSS = false;

        // ç›‘å¬ç›®æ ‡é€‰æ‹©å˜åŒ–
        document.getElementById('targetType').addEventListener('change', updateSynthesisVisibility);
        document.getElementById('targetQuality').addEventListener('change', updateSynthesisVisibility);

        function updateSynthesisVisibility() {
            const panel = document.getElementById('synthesisPanel');
            const targetType = document.getElementById('targetType').value;
            const targetQuality = document.getElementById('targetQuality').value;
            
            // ä»…å½“åŒæ—¶é€‰æ‹©å‚²å¤©å’ŒSSæ—¶æ˜¾ç¤º
            panel.style.display = (targetType === 'å‚²å¤©' && targetQuality === 'SS') ? 'block' : 'none';
            
            // å¦‚æœä¸ç¬¦åˆæ¡ä»¶æ—¶å¼ºåˆ¶å…³é—­è‡ªåŠ¨åˆæˆ
            if (panel.style.display === 'none') {
                isAutoSynthesis = false;
                document.getElementById('autoSynthesisBtn').textContent = 'âš™ï¸ å¯ç”¨è‡ªåŠ¨åˆæˆ';
                document.getElementById('autoSynthesisBtn').style.backgroundColor = '#f9c74f';
            }
        }

        // åˆ‡æ¢è‡ªåŠ¨åˆæˆ
        function toggleAutoSynthesis() {
            isAutoSynthesis = !isAutoSynthesis;
            const btn = document.getElementById('autoSynthesisBtn');
            btn.textContent = isAutoSynthesis ? 'âš™ï¸ è‡ªåŠ¨åˆæˆ(ON)' : 'âš™ï¸ å¯ç”¨è‡ªåŠ¨åˆæˆ';
            btn.style.backgroundColor = isAutoSynthesis ? '#f9844a' : '#f9c74f';
        }

        function getRandomType() {
            const rand = Math.random() * 100;
            if (rand < 98.794) return 'æ™®é€š';
            if (rand < 98.794 + 1.2) return 'ç‰¹æ®Š';
            return 'å‚²å¤©';
        }

        function getRandomQuality(type) {
            const rand = Math.random() * 100;
            // å¦‚æœæ˜¯å‚²å¤©ï¼Œæœ€ä½å“è´¨ä¸ºA
            if (type === 'å‚²å¤©') {
                if (rand < 92.3809) return 'A';  // Açº§: 51.746% + 40.6349%
                if (rand < 92.3809 + 6.6667) return 'S';  // Sçº§: 6.6667%
                return 'SS';  // SSçº§: 0.9524%
            }
            // å…¶ä»–ç±»å‹ä¿æŒåŸæœ‰æ¦‚ç‡
            if (rand < 40.6349) return 'B';
            if (rand < 40.6349 + 51.746) return 'A';
            if (rand < 40.6349 + 51.746 + 6.6667) return 'S';
            return 'SS';
        }

        function toggleFastMode() {
            isFastMode = !isFastMode;
            const btn = document.getElementById('fastModeBtn');
            btn.style.backgroundColor = isFastMode ? '#f9844a' : '#f9c74f';
            btn.textContent = isFastMode ? 'ğŸš€ æé€Ÿæ¨¡å¼(ON)' : 'ğŸš€ æé€Ÿæ¨¡å¼';
            
            // æ–°å¢ï¼šæ§åˆ¶æœ€è¿‘æŠ½å–è®°å½•çš„æ˜¾ç¤º
            document.getElementById('recentCard').style.display = isFastMode ? 'none' : 'block';
            
            // æ–°å¢ï¼šæ¸…ç©ºå·²æœ‰è®°å½•
            if(isFastMode) {
                allResults = [];
                updateRecentTable();
            }
        }

        function updateStats() {
            document.getElementById('totalDraws').textContent = totalDraws;
            document.getElementById('totalCost').textContent = (totalDraws * costPerDraw).toLocaleString();
        }

        function updateRecentTable() {
            const tbody = allResults.map(r => `
                <tr>
                    <td>${r.type}</td>
                    <td>${r.quality}</td>
                    <td>${r.time}</td>
                </tr>
            `).join('');
            document.getElementById('recentResults').innerHTML = `
                <tr><th>ç±»å‹</th><th>å“è´¨</th><th>æ—¶é—´</th></tr>
                ${tbody}
            `;
        }

        function updateCombinationStats(comboKey) {
            const row = document.getElementById(comboKey);
            if (row) {
                row.cells[2].textContent = combinationStats[comboKey].count;
            }
        }

        // ä¿®æ”¹åçš„addResultå‡½æ•°
        function addResult(result) {
            totalDraws++;
            costPerDraw = parseFloat(document.getElementById('costPerDraw').value) || 0;
            
            // å¦‚æœæ˜¯å‚²å¤©å¡ä¸”å¼€å¯åˆæˆ
            if (result.type === 'å‚²å¤©' && isAutoSynthesis) {
                inventory[result.quality]++;
                updateInventoryDisplay();
                checkSynthesis();
            }

            // æ›´æ–°ç»„åˆç»Ÿè®¡
            const comboKey = `${result.type}${result.quality}`;
            combinationStats[comboKey].count++;
            updateCombinationStats(comboKey);
            
            // ä¿®æ”¹ï¼šä»…åœ¨éæé€Ÿæ¨¡å¼è®°å½•æœ€è¿‘æŠ½å–
            if(!isFastMode) {
                allResults.unshift({
                    ...result,
                    time: new Date().toLocaleTimeString()
                });
                if (allResults.length > 10) allResults.pop();
                updateRecentTable();
            }
            
            updateStats();

            // è¿”å›æ˜¯å¦é€šè¿‡åˆæˆå¾—åˆ°SS
            return synthesizedSS;
        }

        function checkSynthesis() {
            let updated = true;
            while(updated) {
                updated = false;
                
                if (inventory.B >= 2) {
                    inventory.B -= 2;
                    inventory.A++;
                    updated = true;
                    showSynthesisAlert('2ä¸ªBçº§ â†’ 1ä¸ªAçº§');
                }
                
                if (inventory.A >= 2) {
                    inventory.A -= 2;
                    inventory.S++;
                    updated = true;
                    showSynthesisAlert('2ä¸ªAçº§ â†’ 1ä¸ªSçº§');
                }
                
                if (inventory.S >= 2) {
                    inventory.S -= 2;
                    inventory.SS++;
                    synthesizedSS = true;
                    updated = true;
                    showSynthesisAlert('2ä¸ªSçº§ â†’ 1ä¸ªSSçº§');
                }
                
                updateInventoryDisplay();
            }
        }

        // æ›´æ–°åº“å­˜æ˜¾ç¤º
        function updateInventoryDisplay() {
            document.getElementById('inventoryB').textContent = inventory.B;
            document.getElementById('inventoryA').textContent = inventory.A;
            document.getElementById('inventoryS').textContent = inventory.S;
            document.getElementById('inventorySS').textContent = inventory.SS;
        }

        // åˆæˆæç¤º
        function showSynthesisAlert(message) {
            if (!isFastMode) {
                const div = document.createElement('div');
                div.textContent = `å‚²å¤©åˆæˆæˆåŠŸï¼š${message}`;
                div.style.position = 'fixed';
                div.style.bottom = '20px';
                div.style.right = '20px';
                div.style.background = '#4CAF50';
                div.style.color = 'white';
                div.style.padding = '15px';
                div.style.borderRadius = '8px';
                div.style.zIndex = '9999';
                document.body.appendChild(div);
                setTimeout(() => div.remove(), 2000);
            }
        }

        async function draw(times = 1) {
            if (isDrawing) return;
            isDrawing = true;
            
            for (let i = 0; i < times && isDrawing; i++) {
                const type = getRandomType();
                const result = {
                    type: type,
                    quality: getRandomQuality(type)
                };
                
                addResult(result);
                
                if (!isFastMode) {
                    await new Promise(r => setTimeout(r, 30));
                    updateRecentTable();
                    updateStats();
                }
            }
            
            if (isFastMode) {
                updateRecentTable();
                updateStats();
            }
            
            isDrawing = false;
        }

        async function startTargetDraw() {
            updateSynthesisVisibility();
            isDrawing = true;
            const targetType = document.getElementById('targetType').value;
            const targetQuality = document.getElementById('targetQuality').value;
            const enableSynthesis = (targetType === 'å‚²å¤©' && targetQuality === 'SS');
            const shouldFastMode = isFastMode;
            const delay = shouldFastMode ? 0 : 30;

            while(isDrawing) {
                const type = getRandomType();
                const result = {
                    type: type,
                    quality: getRandomQuality(type)
                };
                
                const isSSSynthesized = addResult(result);

                const typeMatch = targetType === 'any' || result.type === targetType;
                const qualityMatch = targetQuality === 'any' || result.quality === targetQuality;
                
                if ((typeMatch && qualityMatch) || (enableSynthesis && isSSSynthesized)) {
                    isDrawing = false;
                    alert(`ğŸ‰ æˆåŠŸåœ¨ç¬¬${totalDraws}æŠ½è·å¾—ç›®æ ‡ï¼\nç±»å‹ï¼š${result.type}\nå“è´¨ï¼š${result.quality}`);
                    break;
                }
                
                if (!shouldFastMode) {
                    await new Promise(r => setTimeout(r, delay));
                }
            }
            isDrawing = false;
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function resetData() {
            totalDraws = 0;
            allResults = [];
            inventory = { B: 0, A: 0, S: 0, SS: 0 }; // é‡ç½®åº“å­˜
            synthesizedSS = false; // é‡ç½®åˆæˆçŠ¶æ€
            
            // é‡ç½®ç»„åˆç»Ÿè®¡
            Object.keys(combinationStats).forEach(key => {
                combinationStats[key].count = 0;
                updateCombinationStats(key);
            });
            
            isDrawing = false; // ç¡®ä¿åœæ­¢å½“å‰æŠ½å¡
            
            // æ›´æ–°æ˜¾ç¤º
            updateInventoryDisplay();
            updateRecentTable();
            updateStats();
            updateSynthesisVisibility();
            
            // é‡ç½®æŠ½å¡ä»·æ ¼ä¸ºé»˜è®¤å€¼
            document.getElementById('costPerDraw').value = '2.6';
        }
    </script>
</body>
</html>